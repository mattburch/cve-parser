package main

import (
	"sort"
)

type By func(c1, c2 *CVSS) bool

func (by By) Sort(cvsslist []CVSS) {
	cvesort := &cveSorter{
		cves: cvsslist,
		by:   by,
	}
	sort.Sort(cvesort)
}

type cveSorter struct {
	cves []CVSS
	by   func(c1, c2 *CVSS) bool
}

func (c *cveSorter) Len() int {
	return len(c.cves)
}

func (c *cveSorter) Swap(i, j int) {
	c.cves[i], c.cves[j] = c.cves[j], c.cves[i]
}

func (c *cveSorter) Less(i, j int) bool {
	return c.by(&c.cves[i], &c.cves[j])
}

func listSort(cvsslist []CVSS) {
	score := func(c1, c2 *CVSS) bool {
		return c1.Score > c2.Score
	}

	By(score).Sort(cvsslist)
}
